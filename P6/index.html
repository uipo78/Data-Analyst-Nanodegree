<!-- TODO: finish axes and add apply them to transform -->

<!DOCTYPE html>
<html>
<head>
	<script src='https://d3js.org/d3.v4.js'></script>
	<script src='js\d3.hexbin.min.js'></script>
	<script src='js\d3.topojson.v1.min.js'></script>
	<style type="text/css">
		.hexagon {
		  stroke: #000;
		  stroke-opacity: .2;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		d3.csv('death_location.csv', function(death_loc) {
			var dim = {
				w: 512,
				h: 512
			};
			
			var domain = {
				min: {x: -120, y: 120},
				max: {x: 14870, y: 14980}
			};

			var color = d3.scaleSequential(d3.interpolateInferno)
				.domain([0, death_loc.length]);

			var xScale = d3.scaleLinear()
				.domain([domain.min.x, domain.max.x])
				.range([0, dim.w]);

			var yScale = d3.scaleLinear()
				.domain([domain.min.y, domain.max.y])
				.range([dim.h, 0]);

			death_loc.forEach(function(el) {
				el.x = xScale(el.x)
				el.y = yScale(el.y)
			});

			var hexbin = d3.hexbin()
				.size([dim.w, dim.h])
				.x(function(d) { return d.x; })
				.y(function(d) { return d.y; })
				.radius(3);

			var svg = d3.select('body')
				.append('svg')
					.attr('width', dim.w)
					.attr('height', dim.h);

			svg.append('clipPath')
				.attr('id', 'clip')
				.append('rect')
					.attr('class', 'mesh')
					.attr('width', dim.w)
					.attr('height', dim.h);

			svg.append('g')
				.attr('clip-path', 'url(#clip)')
				.selectAll('.hexagon')
					.data(hexbin(death_loc)).enter()
				.append('path')
					.attr('class', 'hexagon')
					.attr('d', hexbin.hexagon())
					.attr('transform', function(d) { 
						return 'translate(' + d.x + ',' + d.y + ')';
					})
					.style('fill', function(d) { return color(d.length); });
			});
	</script>
</body>
</html>