<!-- TODO: 
		* Make time toggle bar
		* Have something that shows percentage of deaths displayed when toggle bar is set
		  to show a subinterval of time of the deaths
-->

<!DOCTYPE html>
<html>
<head>
	<script src='https://d3js.org/d3.v4.js'></script>
	<script src='js\d3.hexbin.min.js'></script>
	<style type="text/css">
		.hexagon {
		  stroke: #000;
		  stroke-opacity: .2;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		var margin = {
			r: 30,
			b: 30
		},
		    dim = {
			w: 542 - margin.r,
			h: 542 - margin.b
		};

		var svg = d3.select('body')
			.append('svg')
				.attr('width', dim.w + margin.r)
				.attr('height', dim.h + margin.b);

		// Lay Summoner's Rift
		var urlSummoners = 'https://s3-us-west-1.amazonaws.com/riot-api/img/minimap-ig.png';
		svg.append('image')
		    .attr('xlink:href', urlSummoners)
		    .attr('x', '0')
		    .attr('y', '0')
		    .attr('width', dim.w)
		    .attr('height', dim.h);

		// Create grid for hexbins
		svg.append('clipPath')
			.attr('id', 'clip')
			.append('rect')
				.attr('class', 'mesh')
				.attr('width', dim.w)
				.attr('height', dim.h);
		
		// Create lower chart
		var lowerHeight = 150 - margin.b;

		var lowerChart = d3.select('#chart').classed('chart', true)
			.append('svg').classed('navigator', true)
			.attr('width', dim.w + margin.r)
			.attr('height', lowerHeight + margin.b)

		var domain = {
			min: {x: 0, y: 0},
			max: {x: 14820, y: 14881}
		};

		var xScale = d3.scaleLinear()
			.domain([domain.min.x, domain.max.x])
			.range([0, dim.w]);

		var yScale = d3.scaleLinear()
			.domain([domain.min.y, domain.max.y])
			.range([dim.h, 0]);

		d3.csv('death_location.csv', function(deathLoc) {		
			var hexbin = d3.hexbin()
				.size([dim.w, dim.h])
				.x(function(d) { return d.x; })
				.y(function(d) { return d.y; })
				.radius(2);

			deathLoc.forEach(function(d) {
				d.x = xScale(d.x)
				d.y = yScale(d.y)
			});

			var hbinData = hexbin(deathLoc);

			// Note: domain maximum is max count out of all hexbins
			var color = d3.scaleSequential(d3.interpolateInferno)
			    	.domain([0, d3.max(hbinData, function(d) { return d.length; })]);

			// Display hexbins
			svg.append('g')
				.attr('clip-path', 'url(#clip)')
				.selectAll('.hexagon')
					.data(hbinData).enter()
				.append('path')
					.attr('class', 'hexagon')
					.attr('d', hexbin.hexagon())
					.attr('transform', function(d) { 
						return 'translate(' + d.x + ',' + d.y + ')';
					})
					.style('fill', function(d) { return color(d.length); });

		});
	</script>
</body>
</html>